(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-discount-coupon-list"],{1346:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,mode:"form"},on:{open:function(t){arguments[0]=t=e.$handleEvent(t),e.onOpen.apply(void 0,arguments)},closed:function(t){arguments[0]=t=e.$handleEvent(t),e.onClose.apply(void 0,arguments)}},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[n("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},i=[]},3e3:function(e,t,n){var o=n("640a");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=n("4f06").default;i("6fe68c8b",o,!0,{sourceMap:!1,shadowMode:!1})},"5ff8":function(e,t,n){"use strict";n.r(t);var o=n("e56e"),i=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},"640a":function(e,t,n){var o=n("24fb");t=o(!1),t.push([e.i,"",""]),e.exports=t},"71d8":function(e,t,n){"use strict";n.r(t);var o=n("8226"),i=n("5ff8");for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("9282");var u=n("f0c5"),c=Object(u["a"])(i["default"],o["b"],o["c"],!1,null,"6e72ce06",null,!1,o["a"],void 0);t["default"]=c.exports},8226:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"page-body"},[n("vk-data-table-query",{attrs:{columns:e.queryForm1.columns,size:"mini"},on:{search:function(t){arguments[0]=t=e.$handleEvent(t),e.search.apply(void 0,arguments)}},model:{value:e.queryForm1.formData,callback:function(t){e.$set(e.queryForm1,"formData",t)},expression:"queryForm1.formData"}}),n("v-uni-view",[n("el-row",[n("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-circle-plus-outline"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.addBtn.apply(void 0,arguments)}}},[e._v("添加")])],1)],1),n("vk-data-table",{ref:"table1",attrs:{action:e.table1.action,columns:e.table1.columns,"query-form-param":e.queryForm1,"right-btns":["detail_auto","update","delete"],"custom-right-btns":e.table1.customRightBtns,"default-sort":{name:"sort",type:"asc"},selection:!1,"row-no":!0,pagination:!0,size:"mini"},on:{update:function(t){arguments[0]=t=e.$handleEvent(t),e.updateBtn.apply(void 0,arguments)},delete:function(t){arguments[0]=t=e.$handleEvent(t),e.deleteBtn.apply(void 0,arguments)},"current-change":function(t){arguments[0]=t=e.$handleEvent(t),e.currentChange.apply(void 0,arguments)},"selection-change":function(t){arguments[0]=t=e.$handleEvent(t),e.selectionChange.apply(void 0,arguments)}},scopedSlots:e._u([{key:"sort",fn:function(t){var o=t.row;t.column,t.index;return[n("el-input",{attrs:{size:"mini"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.sortChange(t,o)}},model:{value:o.sort,callback:function(t){e.$set(o,"sort",t)},expression:"row.sort"}})]}}])}),n("vk-data-dialog",{attrs:{title:e.form1.props.title,width:"500px",mode:"form","close-on-click-modal":!0},model:{value:e.form1.props.show,callback:function(t){e.$set(e.form1.props,"show",t)},expression:"form1.props.show"}},[n("vk-data-form",{attrs:{rules:e.form1.props.rules,action:e.form1.props.action,"form-type":e.form1.props.formType,columns:e.form1.props.columns,"label-width":"80px"},on:{success:function(t){arguments[0]=t=e.$handleEvent(t),e.form1.props.show=!1,e.refresh()}},model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1),n("giveCoupon",{on:{success:function(t){arguments[0]=t=e.$handleEvent(t),e.refresh.apply(void 0,arguments)}},model:{value:e.formDatas.giveCoupon,callback:function(t){e.$set(e.formDatas,"giveCoupon",t)},expression:"formDatas.giveCoupon"}})],1)},i=[]},9282:function(e,t,n){"use strict";var o=n("3000"),i=n.n(o);i.a},9569:function(e,t,n){"use strict";var o;n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=uni.vk,a=(i.getVuex("$app.config.maill.coupon.type"),{props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{page:{title:"标题",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"7vh",width:"800px"},form1:{data:{},props:{action:"admin/business/sys.coupon.giveCoupon",columns:[{key:"name",title:"优惠券标题",type:"text-view"},{key:"coupon_rule_msg",title:"优惠内容",type:"text-view"},{key:"user_id",title:"用户",type:"table-select",placeholder:"请选择赠送的用户",action:"admin/business/sys.user.getList",multiple:!0,formData:{is_fx:1},columns:[{key:"avatar",title:"头像",type:"avatar",width:60},{key:"nickname",title:"昵称",type:"text",nameKey:!0},{key:"mobile",title:"手机",type:"text"},{key:"comment",title:"备注",type:"text"},{key:"_id",title:"角色标识",type:"text",idKey:!0,show:["none"]}],queryColumns:[{key:"nickname",title:"昵称",type:"text",width:160,mode:"%%"},{key:"mobile",title:"手机号",type:"text",width:160,mode:"%%",lastWhereJson:!0},{key:"comment",title:"备注",type:"text",width:160,mode:"%%"},{key:"is_fx",title:"状态",type:"number",width:160,mode:"=",fieldName:"fx.is_fx",show:["none"]}],disabled:["update"]},{key:"num",title:"赠送数量",type:"number",width:160,rightText:"张",clearable:!1}],rules:{},labelWidth:"120px"}}}},mounted:function(){o=this,o.init()},methods:{init:function(){var e=o,t=e.value;o.$emit("input",t)},onOpen:function(){o=this;var e=o.value.item,t=void 0===e?{}:e;o.form1.data={_id:t._id,name:t.name,coupon_rule_msg:t.coupon_rule_msg,user_id:"",num:1}},onClose:function(){},onFormSuccess:function(){o.value.show=!1,o.$emit("success")}},watch:{},computed:{}});t.default=a},ae2f:function(e,t,n){"use strict";n.r(t);var o=n("1346"),i=n("cb3a");for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);var u=n("f0c5"),c=Object(u["a"])(i["default"],o["b"],o["c"],!1,null,"4998a044",null,!1,o["a"],void 0);t["default"]=c.exports},cb3a:function(e,t,n){"use strict";n.r(t);var o=n("9569"),i=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},e56e:function(e,t,n){"use strict";n("7a82");var o=n("ee27").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(n("fc11"));n("99af"),n("ac1f"),n("841c"),n("a9e3");var a,u=o(n("ae2f")),c=uni.vk,r={},l=c.getVuex("$app.config.maill.coupon.type"),s={components:{giveCoupon:u.default},data:function(){var e,t;return{loading:!1,data:{},table1:{action:"admin/business/sys.coupon.getList",columns:[{key:"sort",title:"排序",type:"number",width:80,defaultValue:"0",sortable:"custom"},{key:"status",title:"状态",type:"radio",itemWidth:80,data:[{value:-1,label:"已删除"},{value:0,label:"下架"},{value:1,label:"上架"}]},{key:"name",title:"优惠券标题",type:"text",width:150},{key:"type",title:"类型",type:"select",itemWidth:100,data:l},{key:"coupon_rule_msg",title:"优惠规则说明",type:"text",width:100},{key:"receive_start_time",title:"最早可领取时间",type:"time",width:150,sortable:"custom"},{key:"receive_end_time",title:"最晚可领取时间",type:"time",width:150,sortable:"custom"},{key:"effective_time_rule",title:"有效期",type:"text",width:200,formatter:function(e,t,n,o){try{var i="",a=e.fixed_time[0],u=e.fixed_time[1];return i=0===e.type?"".concat(c.pubfn.timeFormat(a)," - ").concat(c.pubfn.timeFormat(u)):"领取第".concat(a,"天生效，有效期").concat(u,"天"),i}catch(r){return""}}},{key:"receive_rule",title:"领取规则",type:"text",width:160,formatter:function(e,t,n,o){try{var i="";return 0===e.type?i="所有用户可领（lv>=0）":1===e.type?i="所有会员可领（lv>=1）":2===e.type&&(i="部分会员可领"),i}catch(a){return""}}},{key:"share_info",title:"分享信息",type:"object",width:100,show:["detail"],columns:[{key:"title",title:"分享标题",type:"text",width:100},{key:"image",title:"封面图",type:"image",width:100}]},{key:"stock",title:"库存（张）",type:"number",width:100},(e={key:"is_public",title:"可公开领取",type:"switch",width:100,activeValue:!0,inactiveValue:!1},(0,i.default)(e,"width",100),(0,i.default)(e,"watch",(function(e){var t=e.value,n=e.row,o=e.change;c.callFunction({url:"admin/business/sys.coupon.updateBySwitch",title:"请求中...",data:{_id:n._id,is_public:t},success:function(e){o(t)}})})),e),(t={key:"only_original_price_use",title:"仅原价购买可用",type:"switch",width:100,activeValue:!0,inactiveValue:!1},(0,i.default)(t,"width",100),(0,i.default)(t,"watch",(function(e){var t=e.value,n=e.row,o=e.change;c.callFunction({url:"admin/business/sys.coupon.updateBySwitch",title:"请求中...",data:{_id:n._id,only_original_price_use:t},success:function(e){o(t)}})})),t),{key:"limit",title:"领取上限",type:"number",width:100},{key:"describe",title:"使用说明",type:"text",width:100,show:["detail"]},{key:"remark",title:"商家备注",type:"text",width:200},{key:"available_range_rule",title:"可用范围规则",type:"text",width:100,formatter:function(e,t,n,o){try{var i="";return 0===e.type?i="全部商品可以":(1===e.type||2===e.type)&&(i="部分商品可用"),i}catch(a){return""}}},{key:"_add_time",title:"添加时间",type:"time",width:160,sortable:"custom"},{key:"_add_time",title:"距离现在",type:"dateDiff",width:120}],multipleSelection:[],selectItem:"",customRightBtns:[{title:"赠送",type:"success",onClick:function(e){c.pubfn.openForm("giveCoupon",{item:e})}},{title:"复制创建",type:"success",onClick:function(e){c.navigateTo({url:"./edit?mode=add",events:{add:function(e){a.refresh()}},success:function(t){t.eventChannel.emit("data",e)}})}}]},queryForm1:{formData:{},columns:[{key:"type",title:"类型",type:"select",width:130,data:l},{key:"remark",title:"备注",type:"text",width:160,mode:"%%"},{key:"receive_start_time",title:"领取时间",type:"date",dateType:"date",width:160,mode:"<="},{key:"receive_end_time",title:"-",type:"date",dateType:"date",width:160,mode:">="}]},form1:{data:{},props:{action:"",columns:[],rules:{},formType:"",show:!1}},formDatas:{}}},onLoad:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a=this,c=a.vk,a.options=e,a.init(e)},onReady:function(){},onShow:function(){},onHide:function(){},methods:{init:function(e){r["form1"]=c.pubfn.copyObject(a.form1)},pageTo:function(e){c.navigateTo(e)},resetForm:function(){c.pubfn.resetForm(r,a)},search:function(){a.$refs.table1.search()},refresh:function(){a.$refs.table1.refresh()},getCurrentRow:function(){return a.$refs.table1.getCurrentRow()},currentChange:function(e){a.table1.selectItem=e},selectionChange:function(e){a.table1.multipleSelection=e},addBtn:function(){c.navigateTo({url:"./edit?mode=add",events:{add:function(e){a.refresh()}},success:function(e){}})},updateBtn:function(e){var t=e.item;c.navigateTo({url:"./edit?mode=update&_id=".concat(t._id),events:{update:function(e){c.pubfn.objectAssign(t,e)}},success:function(e){e.eventChannel.emit("data",t)}})},deleteBtn:function(e){var t=e.item,n=e.deleteFn;n({action:"admin/business/sys.coupon.delete",data:{_id:t._id}})},batchBtn:function(e){switch(e){case 1:c.toast("批量操作按钮1");break;case 2:c.toast("批量操作按钮2");break;default:break}},sortChange:function(e,t){c.callFunction({url:"admin/business/sys.coupon.updateGoodsSort",data:{_id:t._id,sort:Number(e)},success:function(e){}})}},watch:{},computed:{}};t.default=s}}]);