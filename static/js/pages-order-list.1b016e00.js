(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-order-list"],{"0296":function(e,t,n){"use strict";n("7a82");var o=n("ee27").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("fc11"));n("99af"),n("d3b7"),n("159b"),n("c975"),n("d81d"),n("ac1f"),n("841c"),n("14d9");var i,r=o(n("a05c")),u=o(n("ef5e")),s=o(n("a860")),l=o(n("819a")),d=o(n("e37f")),c=o(n("26c6")),f=o(n("7204")),m=o(n("7294")),p=o(n("ddd7")),v=o(n("3e1a")),_=uni.vk,y={},h={components:{userRecords:r.default,orderDetail:u.default,updateReceiverInfo:s.default,updateRemark:l.default,express:d.default,orderRefund:c.default,orderRefundExamine:f.default,orderSend:m.default,updatePrice:p.default,exportExcel:v.default},data:function(){var e;return{loading:!1,orderCountGroup:{},data:{},table1:{action:"admin/business/sys.order.getList",columns:[{key:"goods_info",title:"活动名称",type:"text",minWidth:210,align:"left",showOverflowTooltip:!1,formatter:function(e,t,n,o){var a="".concat(e.name,"*").concat(t.buy_num," ");return a}},(e={key:"order_info",title:"订单信息",type:"group",minWidth:250,showOverflowTooltip:!1},(0,a.default)(e,"showOverflowTooltip",!1),(0,a.default)(e,"columns",[{key:"order_no",title:"订单编号",type:"text"},{key:"status",title:"订单状态",type:"tag",size:"mini",formatter:function(e,t,n,o){var a=_.pubfn.getListItem([{value:-3,label:"已退款",tagType:"info"},{value:-2,label:"申请退款中",tagType:"danger"},{value:-1,label:"已取消",tagType:"info"},{value:0,label:"未付款",tagType:"info"},{value:1,label:"已付款",tagType:"success"},{value:2,label:"准备发货中",tagType:"success"},{value:3,label:"已部分发货",tagType:"warning"},{value:4,label:"待开始",tagType:"success"},{value:5,label:"进行中",tagType:"success"},{value:6,label:"已完成",tagType:"success"}],"value",e);return{val:a.label,tagType:a.tagType}}},{key:"pay_time",title:"付款时间",type:"time",defaultValue:"-"},{key:"buyer_remark",title:"留言",type:"text",style:"color:#f56c6c"}]),e),{key:"buyer_info",title:"买家信息",type:"group",minWidth:170,align:"left",showOverflowTooltip:!1,columns:[{key:"buyer_info.avatar",title:"头像",type:"avatar",shape:"square",imageWidth:40,buttons:[{title:"查看",type:"text",click:function(e){uni.vk.navigateTo("/pages/user/list?_id=".concat(e.row.user_id))}}]},{key:"buyer_info.nickname",title:"昵称",type:"text"},{key:"pay_type",title:"付款",type:"select",data:[{value:"wxpay",label:"微信"},{value:"alipay",label:"支付宝"},{value:"balance",label:"余额"},{value:"offline",label:"线下支付"},{value:"none",label:"无需支付"}]}]},{key:"amount_info",title:"金额（元）",type:"object",minWidth:220,showOverflowTooltip:!1,columns:[{key:"should_payment_amount",title:"应付",type:"money",defaultValue:"-"},{key:"payment_amount",title:"实付",type:"money",defaultValue:"-"},{key:"refund_amount",title:"退款金额",type:"money",defaultValue:"-"}]},{key:"travel_user_list",title:"出行人信息",type:"html",minWidth:220,formatter:function(e,t,n,o){var a="";return t.travel_user_list.forEach((function(e,t){a+="出行人".concat(t+1,": ").concat(e.name,'<text style="margin-right: 20px"></text>').concat(e.mobile,' <text style="margin-right: 20px">身份证号码</text>').concat(e.idCardNo,"<br />")})),a}}],multipleSelection:[],selectItem:"",rightBtnsMore:[{title:"订单主动退款",onClick:function(e){_.pubfn.openForm("orderRefund",{item:e})},show:function(e){return[1,2,3,4,5].indexOf(e.status)>-1}}],customRightBtns:[{title:"发货",type:"primary",icon:"el-icon-edit",onClick:function(e){_.pubfn.openForm("orderSend",{item:e})},show:function(e){return e.enable_delivery&&[1,2,3].indexOf(e.status)>-1}},{title:"处理",type:"warning",icon:"el-icon-edit",onClick:function(e){_.pubfn.openForm("orderRefundExamine",{item:e})},show:function(e){return[-2].indexOf(e.status)>-1}}]},queryForm1:{formData:{status:""},columns:[{key:"user_id",title:"下单用户",type:"remote-select",placeholder:"请输入用户账号",width:160,action:"admin/select/kh/user"},{key:"order_no",title:"订单号",type:"text",width:160,mode:"%%"},{key:"pay_time",title:"付款时间",type:"datetimerange",width:340,mode:"[]"},{key:"goods_id",title:"活动",type:"table-select",placeholder:"选择活动",fieldName:"goods_id",action:"admin/business/sys.goods.getList",mode:"=",formData:{status:0},columns:[{key:"goods_thumb",title:"活动展示图",type:"avatar",imageWidth:40},{key:"name",title:"活动名称",type:"text",width:160,align:"left"},{key:"categoryList",title:"所属分类",type:"text",width:140,defaultValue:"暂无",formatter:function(e,t,n,o){var a="";return e.map((function(e,t){t>0&&(a+="、"),a+=e.name})),a}},{key:"stock",title:"剩余报名人数",type:"number",width:110,show:["row"]}],queryColumns:[{key:"name",type:"text",title:"活动名称",placeholder:"活动名称",width:220,mode:"%%"},{key:"category_ids",title:"分类",type:"cascader",width:250,mode:"in",action:"admin/business/sys.goodsCategory.kh_getList",props:{list:"rows",value:"_id",label:"name",children:"children",checkStrictly:!0,emitPath:!1}},{key:"_id",title:"标识",type:"text",width:150,mode:"=",show:!1}]},{key:"status",title:"订单状态",type:"text",width:160,mode:"=",show:["none"]}]},formDatas:{}}},onLoad:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i=this,_=i.vk,i.options=e,i.init(e)},onReady:function(){},onShow:function(){},onHide:function(){},methods:{init:function(e){e.goods_id&&i.$set(i.queryForm1.formData,"goods_ids",e.goods_id),i.groupCountOrderForStatus()},groupCountOrderForStatus:function(){_.callFunction({url:"admin/business/sys.order.groupCountOrderForStatus",data:i.queryForm1,success:function(e){i.orderCountGroup=e.group}})},pageTo:function(e){_.navigateTo(e)},resetForm:function(){_.pubfn.resetForm(y,i)},search:function(){i.$refs.table1.search(),i.groupCountOrderForStatus()},refresh:function(){i.$refs.table1.refresh(),i.groupCountOrderForStatus()},getCurrentRow:function(){return i.$refs.table1.getCurrentRow()},currentChange:function(e){i.table1.selectItem=e},selectionChange:function(e){i.table1.multipleSelection=e},batchBtn:function(e){switch(e){case 1:i.readyDeliver(1);break;case 2:i.readyDeliver(-1);break;default:break}},readyDeliver:function(e){var t=[],n=0,o="",a="";1==e?(o=1,a="订单状态为已付款才能修改!"):(e=-1,o=2,a="订单状态为准备发货状态才能取消!"),i.table1.multipleSelection.map((function(e,a){e.status===o&&n++,t.push(e._id)})),n===i.table1.multipleSelection.length?_.callFunction({url:"admin/business/sys.order.updateReadySend",data:{ids:t,mode:e},title:"修改中...",success:function(e){i.refresh()}}):i.$message.error({message:a,type:"warning",duration:1800})},showExportExcel:function(){_.pubfn.openForm("exportExcel",{columns:this.table1.columns})},exportExcel:function(e){i.$refs.table1.exportExcel({columns:e})}},watch:{},computed:{}};t.default=h},"0b2a":function(e,t,n){"use strict";n.r(t);var o=n("8a45"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},"17e5":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,"destroy-on-close":!1,top:"4vh",mode:"form"},on:{open:function(t){arguments[0]=t=e.$handleEvent(t),e.onOpen.apply(void 0,arguments)},closed:function(t){arguments[0]=t=e.$handleEvent(t),e.onClose.apply(void 0,arguments)}},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[n("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText,"submit-disabled":e.submitDisabledCom,"max-height":"80vh"},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},scopedSlots:e._u([{key:"addressInfo",fn:function(t){t.form,t.keyName;return[n("v-uni-text",[e._v(e._s(e.orderInfo.express_info.formatted_address))]),n("v-uni-text",{staticStyle:{"margin-left":"6px"}},[e._v(e._s(e.orderInfo.express_info.receiver_mobile))]),n("v-uni-text",{staticStyle:{"margin-left":"6px"}},[e._v(e._s(e.orderInfo.express_info.receiver_name))]),n("v-uni-text",{staticStyle:{"margin-left":"6px","text-decoration":"underline",color:"#409eff",cursor:"pointer"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.copyAddress(e.orderInfo.express_info)}}},[e._v("复制")])]}},{key:"express_no",fn:function(t){var o=t.form,a=t.keyName,i=t.column;return[n("el-input",{ref:"express_no",attrs:{placeholder:"请输入快递单号"},model:{value:o[a],callback:function(t){e.$set(o,a,t)},expression:"form[keyName]"}}),n("vk-data-tips",{attrs:{tips:i.tips}})]}},{key:"goods_sku_list",fn:function(t){var o=t.form,a=t.keyName;return[n("v-uni-view",[n("el-button",{staticStyle:{margin:"0px 0px 10px 10px"},attrs:{size:"mini",type:"primary",disabled:e.allSendDisabled},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.allinSend.apply(void 0,arguments)}}},[e._v("设置全发")]),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"customer-table",staticStyle:{border:"none"},attrs:{data:o[a],"header-cell-style":{textAlign:"center"},"cell-style":{textAlign:"center"}}},[n("el-table-column",{attrs:{prop:"goods_name",label:"产品名称","show-overflow-tooltip":!0,"min-width":"240"}}),n("el-table-column",{attrs:{prop:"max_send_num",label:"可发数量","min-width":"240"}}),n("el-table-column",{attrs:{prop:"send_num",label:"已发数量","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("vk-data-input-number",{staticStyle:{width:"100px",margin:"0 10px"},attrs:{max:t.row.max_send_num,clearable:!1},model:{value:t.row.send_num,callback:function(n){e.$set(t.row,"send_num",n)},expression:"scope.row.send_num"}})]}}],null,!0)})],1)],1)]}}]),model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},a=[]},"1b80":function(e,t,n){"use strict";n.r(t);var o=n("a1c53"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},"1fef":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"page-body"},[n("vk-data-table-query",{attrs:{columns:e.queryForm1.columns,size:"mini"},on:{search:function(t){arguments[0]=t=e.$handleEvent(t),e.search.apply(void 0,arguments)}},model:{value:e.queryForm1.formData,callback:function(t){e.$set(e.queryForm1,"formData",t)},expression:"queryForm1.formData"}}),n("v-uni-view",[n("el-row",[n("el-radio-group",{attrs:{size:"mini"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.search.apply(void 0,arguments)}},model:{value:e.queryForm1.formData.status,callback:function(t){e.$set(e.queryForm1.formData,"status",t)},expression:"queryForm1.formData.status"}},[n("el-radio-button",{attrs:{label:""}},[e._v("全部订单")]),n("el-badge",{staticClass:"group-badge",attrs:{value:e.orderCountGroup["-3"],max:99}},[n("el-radio-button",{attrs:{label:-3}},[e._v("已退款")])],1),n("el-badge",{staticClass:"group-badge",attrs:{value:e.orderCountGroup["0"],max:99}},[n("el-radio-button",{attrs:{label:0}},[e._v("未付款")])],1),n("el-radio-button",{attrs:{label:4}},[e._v("待开始")]),n("el-radio-button",{attrs:{label:5}},[e._v("进行中")]),n("el-radio-button",{attrs:{label:6}},[e._v("已完成")]),n("el-radio-button",{attrs:{label:100}},[e._v("待核销")]),n("el-radio-button",{attrs:{label:101}},[e._v("已核销")])],1),n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning",size:"mini",icon:"el-icon-edit-outline"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.showExportExcel.apply(void 0,arguments)}}},[e._v("订单导出xls")])],1)],1),n("vk-data-table",{ref:"table1",attrs:{action:e.table1.action,columns:e.table1.columns,"query-form-param":e.queryForm1,"right-btns":["detail_auto","more"],"right-btns-more":e.table1.rightBtnsMore,"right-btns-align":"right",size:"mini",selection:!0,"left-fixed":!1,"right-fixed":!1,"row-no":!0,pagination:!0},on:{"current-change":function(t){arguments[0]=t=e.$handleEvent(t),e.currentChange.apply(void 0,arguments)},"selection-change":function(t){arguments[0]=t=e.$handleEvent(t),e.selectionChange.apply(void 0,arguments)}},scopedSlots:e._u([{key:"goods_sku_list",fn:function(t){var o=t.row;t.column,t.index;return[n("v-uni-view",["recharge"==o.type?n("v-uni-view",[n("v-uni-view",{staticStyle:{display:"flex","align-items":"center"}},[n("v-uni-view",{staticStyle:{width:"40px"}},[n("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{src:o.app_info.app_logo}})],1),n("v-uni-view",{staticStyle:{"margin-left":"8px",flex:"1"}},[n("v-uni-view",{staticStyle:{"white-space":"initial"}},[n("v-uni-text",[e._v("余额")]),n("v-uni-text",{staticStyle:{"margin-left":"2px"}},[e._v("× "+e._s(o.amount_info.recharge_balance))])],1),n("v-uni-view",[n("v-uni-text",{staticStyle:{color:"#f2303e"}},[e._v("￥"+e._s(o.amount_info.used_cash_amount))]),[1,2,3].indexOf(o.status)>-1?n("el-popconfirm",{attrs:{title:"退款后，余额和返佣会自动扣除，但现金需要人工操作退款，是否退款？"},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.rechargeRefund(o)}}},[n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{slot:"reference",size:"mini",type:"text"},slot:"reference"},[e._v("主动退款")])],1):e._e()],1)],1)],1)],1):n("v-uni-view",e._l(o.goods_sku_list,(function(t,o){return n("v-uni-view",{key:o,staticStyle:{display:"flex","align-items":"center"},style:{marginTop:o>0?"8px":"0px"}},[n("v-uni-view",{staticStyle:{width:"40px"}},[n("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{src:t.image}})],1),n("v-uni-view",{staticStyle:{"margin-left":"8px",flex:"1"}},[n("v-uni-view",{staticStyle:{"white-space":"initial"}},[n("v-uni-text",{staticClass:"text-two"},[e._v(e._s(t.goods_name))]),n("v-uni-text",{staticStyle:{color:"#aaaaaa"}},[e._v(e._s(t.sku_name))]),n("v-uni-text",{staticStyle:{"margin-left":"2px"}},[e._v("× "+e._s(t.buy_num))])],1),n("v-uni-view",[n("v-uni-text",{staticStyle:{color:"#f2303e"}},[e._v("￥"+e._s(e.vk.pubfn.priceFilter(t.real_price)))])],1),n("v-uni-view",{staticStyle:{"font-size":"12px",display:"flex","flex-wrap":"wrap"}},[t.vip_discount_amount>0?n("el-tag",{staticStyle:{padding:"0 4px",transform:"scale(0.9)"},attrs:{type:"danger",effect:"dark",size:"mini"}},[e._v("会员价")]):e._e(),t.coupon_discount_amount>0?n("el-tag",{staticStyle:{padding:"0 4px",transform:"scale(0.9)"},attrs:{type:"danger",effect:"dark",size:"mini"}},[e._v("券")]):e._e(),t.integral_discount_amount?n("el-tag",{staticStyle:{padding:"0 4px",transform:"scale(0.9)"},attrs:{type:"danger",effect:"dark",size:"mini"}},[e._v("积分")]):e._e(),1===t.is_seckill?n("el-tag",{staticStyle:{padding:"0 4px",transform:"scale(0.9)"},attrs:{type:"danger",effect:"dark",size:"mini"}},[e._v("秒杀")]):e._e(),t.group_buy_discount_price?n("el-tag",{staticStyle:{padding:"0 4px",transform:"scale(0.9)"},attrs:{type:"danger",effect:"dark",size:"mini"}},[e._v("拼团")]):e._e()],1)],1)],1)})),1)],1)]}}])}),n("userRecords",{on:{success:function(t){arguments[0]=t=e.$handleEvent(t),e.refresh.apply(void 0,arguments)}},model:{value:e.formDatas.userRecords,callback:function(t){e.$set(e.formDatas,"userRecords",t)},expression:"formDatas.userRecords"}}),n("orderDetail",{on:{success:function(t){arguments[0]=t=e.$handleEvent(t),e.refresh.apply(void 0,arguments)}},model:{value:e.formDatas.orderDetail,callback:function(t){e.$set(e.formDatas,"orderDetail",t)},expression:"formDatas.orderDetail"}}),n("updateReceiverInfo",{model:{value:e.formDatas.updateReceiverInfo,callback:function(t){e.$set(e.formDatas,"updateReceiverInfo",t)},expression:"formDatas.updateReceiverInfo"}}),n("updateRemark",{model:{value:e.formDatas.updateRemark,callback:function(t){e.$set(e.formDatas,"updateRemark",t)},expression:"formDatas.updateRemark"}}),n("express",{on:{success:function(t){arguments[0]=t=e.$handleEvent(t),e.refresh.apply(void 0,arguments)}},model:{value:e.formDatas.express,callback:function(t){e.$set(e.formDatas,"express",t)},expression:"formDatas.express"}}),n("orderRefund",{on:{success:function(t){arguments[0]=t=e.$handleEvent(t),e.refresh.apply(void 0,arguments)}},model:{value:e.formDatas.orderRefund,callback:function(t){e.$set(e.formDatas,"orderRefund",t)},expression:"formDatas.orderRefund"}}),n("orderRefundExamine",{model:{value:e.formDatas.orderRefundExamine,callback:function(t){e.$set(e.formDatas,"orderRefundExamine",t)},expression:"formDatas.orderRefundExamine"}}),n("orderSend",{model:{value:e.formDatas.orderSend,callback:function(t){e.$set(e.formDatas,"orderSend",t)},expression:"formDatas.orderSend"}}),n("updatePrice",{on:{success:function(t){arguments[0]=t=e.$handleEvent(t),e.refresh.apply(void 0,arguments)}},model:{value:e.formDatas.updatePrice,callback:function(t){e.$set(e.formDatas,"updatePrice",t)},expression:"formDatas.updatePrice"}}),n("exportExcel",{on:{success:function(t){arguments[0]=t=e.$handleEvent(t),e.exportExcel.apply(void 0,arguments)}},model:{value:e.formDatas.exportExcel,callback:function(t){e.$set(e.formDatas,"exportExcel",t)},expression:"formDatas.exportExcel"}})],1)},a=[]},2106:function(e,t,n){"use strict";var o;n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("d81d"),n("e25e");var a=uni.vk,i={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{page:{title:"订单改价",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"7vh",width:"1220px"},form1:{data:{goods_sku_list:[]},props:{action:"admin/business/sys.order.updatePrice",columns:[{key:"goods_sku_list",title:"商品信息",type:"array<object>",showLabel:!1,showAdd:!1,showClear:!1,showSort:!1,defaultValue:{},rightBtns:[],columns:[{key:"image",title:"商品图片",type:"image",width:100,limit:1,disabled:!0},{key:"goods_name",title:"商品名称",type:"text-view",minWidth:180,align:"left",showOverflowTooltip:!0},{key:"sku_name",title:"商品规格",type:"text-view",width:90},{key:"price",title:"商品原价",type:"money-view",width:90,align:"right"},{key:"current_unit_price",title:"当前单价",type:"money-view",width:90,align:"right"},{key:"business_discount_unit_amount",title:"商家优惠",type:"money",width:120,placeholder:"优惠金额",clearable:!1,onChange:function(e,t,n,a,i){t.business_discount_unit_amount>t.payment_unit_price&&(t.business_discount_unit_amount=t.payment_unit_price),o.calcPriceItem(t)}},{key:"buy_num",title:"购买数量",type:"text-view",width:80,clearable:!1,onChange:function(e,t,n,a,i){o.calcPriceItem(t)}},{key:"total_amount",title:"原价合计",type:"money-view",width:90,align:"right"},{key:"should_payment_amount_str",title:"实付合计",type:"text-view",width:150,align:"right"},{key:"total_discount_amount",title:"合计优惠",type:"money-view",width:90,align:"right"}]},{key:"express_amount",title:"运费",type:"money"},{key:"total",title:"合计",type:"text"}],rules:{},labelWidth:"100px"}}}},mounted:function(){o=this,o.init()},methods:{init:function(){var e=o,t=e.value;o.$emit("input",t)},onOpen:function(){o=this;var e=o.value.item,t=void 0===e?{}:e;t.goods_sku_list=o.calcPrice(t.goods_sku_list);var n=t.discount_info.business_discount_express_amount;n||(n=0),o.form1.data={_id:t._id,express_amount:t.amount_info.express_amount+n,business_discount_express_amount:n,goods_sku_list:a.pubfn.copyObject(t.goods_sku_list)},o.calcData()},onClose:function(){},onFormSuccess:function(){o.value.show=!1,o.$emit("success")},calcPrice:function(e){return e||(e=o.form1.data.goods_sku_list),e.map((function(e,t){if(e.total_discount_amount=e.total_amount-e.should_payment_amount,e.should_payment_amount_str=a.pubfn.priceFilter(e.should_payment_amount),e.total_amount>0)if(e.total_amount===e.should_payment_amount)e.should_payment_amount_str+=" (原价)";else{var n=a.pubfn.discountFilter(e.should_payment_amount/e.total_amount);e.should_payment_amount_str+=" (".concat(n,")")}e.current_unit_price=parseInt(e.should_payment_amount/e.buy_num),e.business_discount_amount>0?(e.business_discount_unit_amount=parseInt(e.business_discount_amount/e.buy_num),e.payment_unit_price=parseInt(e.current_unit_price+e.business_discount_unit_amount)):(e.business_discount_unit_amount="",e.payment_unit_price=e.current_unit_price)})),e},calcPriceItem:function(e){e.total_amount=e.price*e.buy_num;var t=e.business_discount_unit_amount,n=void 0===t?0:t;if(e.business_discount_amount=n*e.buy_num,e.current_unit_price=e.payment_unit_price-n,e.should_payment_amount=e.current_unit_price*e.buy_num,e.total_discount_amount=e.total_amount-e.should_payment_amount,e.should_payment_amount_str=a.pubfn.priceFilter(e.should_payment_amount),e.total_amount>0)if(e.total_amount===e.should_payment_amount)e.should_payment_amount_str+="（原价）";else{var i=a.pubfn.discountFilter(e.should_payment_amount/e.total_amount);e.should_payment_amount_str+=" (".concat(i,")")}o.calcData()},calcData:function(){this.$set(this.form1.data,"goodsNum",this.goodsNumFn()),this.$set(this.form1.data,"paymentAmount",this.paymentAmountFn()),this.$set(this.form1.data,"businessDiscountAmount",this.businessDiscountAmountFn()),this.$set(this.form1.data,"expressAmount",this.expressAmountFn())},goodsNumFn:function(){var e=this.form1.data.goods_sku_list,t=0;return e.map((function(e,n){t+=e.buy_num})),t},paymentAmountFn:function(){var e=this.form1.data.goods_sku_list,t=0;return e.map((function(e,n){t+=e.should_payment_amount})),t+=this.expressAmountFn(),t},businessDiscountAmountFn:function(){var e=this.form1.data.goods_sku_list,t=0;return e.map((function(e,n){e.business_discount_amount&&(t+=e.business_discount_amount)})),t},expressAmountFn:function(){this.value;var e=o.form1.data.express_amount||0,t=o.form1.data.business_discount_express_amount||0;return e-t}},watch:{},computed:{}};t.default=i},"26c6":function(e,t,n){"use strict";n.r(t);var o=n("dfbe"),a=n("a27f");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"b8eded54",null,!1,o["a"],void 0);t["default"]=u.exports},"281e":function(e,t,n){"use strict";n.r(t);var o=n("e96f"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},"2c30":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,mode:"form"},on:{open:function(t){arguments[0]=t=e.$handleEvent(t),e.onOpen.apply(void 0,arguments)},closed:function(t){arguments[0]=t=e.$handleEvent(t),e.onClose.apply(void 0,arguments)}},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[n("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},a=[]},3372:function(e,t,n){"use strict";n.r(t);var o=n("9efd"),a=n("6098");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"195057be",null,!1,o["a"],void 0);t["default"]=u.exports},3522:function(e,t,n){"use strict";n("7a82");var o=n("ee27").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=o(n("f3f3"));n("99af"),n("14d9"),n("d81d");var r=uni.vk,u={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{},columns:[]}}}},data:function(){var e=this;return{page:{title:"订单导出（选择需要导出的数据）",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"7vh",width:"800px"},form1:{data:{fields:["goods_sku_list","order_no","status","pay_time","buyer_remark","seller_remark","seller_note","pay_type","buyer_info.nickname","amount_info.total_amount","amount_info.should_payment_amount","amount_info.payment_amount","amount_info.express_amount","express_info.formatted_address","express_info.receiver_name","express_info.receiver_mobile","fx.settlement_status","fx.plan_exec_time","fx.settlement_time","inviterUserInfo.nickname","inviterUserInfo._id"]},props:{action:"",columns:[{key:"",title:"订单信息",type:"bar-title"},{key:"fields",title:"",type:"checkbox",showLabel:!1,itemWidth:100,data:[{value:"goods_sku_list",label:"商品信息"},{value:"order_no",label:"订单编号"},{value:"status",label:"订单状态"},{value:"pay_time",label:"付款时间"},{value:"buyer_remark",label:"买家留言"},{value:"seller_remark",label:"商家备注1"},{value:"seller_note",label:"商家备注2"},{value:"pay_type",label:"付款方式"},{value:"buyer_info.nickname",label:"买家昵称"}]},{key:"",title:"金额信息",type:"bar-title"},{key:"fields",title:"",type:"checkbox",showLabel:!1,itemWidth:100,data:[{value:"amount_info.total_amount",label:"订单原价"},{value:"amount_info.should_payment_amount",label:"应付金额"},{value:"amount_info.payment_amount",label:"实付金额"},{value:"amount_info.express_amount",label:"快递费用"}]},{key:"",title:"收货地址",type:"bar-title"},{key:"fields",title:"",type:"checkbox",showLabel:!1,itemWidth:100,data:[{value:"express_info.formatted_address",label:"收货地址"},{value:"express_info.receiver_name",label:"收货人姓名"},{value:"express_info.receiver_mobile",label:"收货人手机"}]},{key:"",title:"分销信息",type:"bar-title"},{key:"fields",title:"",type:"checkbox",showLabel:!1,itemWidth:100,data:[{value:"fx.settlement_status",label:"结算状态"},{value:"fx.plan_exec_time",label:"计划结算"},{value:"fx.settlement_time",label:"实际结算"},{value:"inviterUserInfo.nickname",label:"上级昵称"},{value:"inviterUserInfo._id",label:"上级ID"}]}],rules:{},labelWidth:"100px",beforeAction:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.value.columns,o=void 0===n?[]:n,u=[];for(var s in o){var l=o[s];if(l.columns)for(var d in l.columns){var c=l.columns[d],f=c.key;"object"==l.type&&(f="".concat(l.key,".").concat(c.key)),u.push((0,i.default)((0,i.default)({},c),{},{key:f}))}else u.push(l)}var m=t.fields,p=void 0===m?[]:m,v=[];return p.map((function(e){var t=r.pubfn.getListItem(u,"key",e);t&&v.push(t)})),a.value.show=!1,a.$emit("success",v),!1}}}}},mounted:function(){a=this,a.init()},methods:{init:function(){var e=a,t=e.value;a.$emit("input",t)},onOpen:function(){a=this;a.value.item},onClose:function(){},onFormSuccess:function(){a.value.show=!1,a.$emit("success")}},watch:{},computed:{}};t.default=u},3657:function(e,t,n){"use strict";var o;n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=uni.vk,i=a.getVuex("$app.config.maill.rec.addType"),r={props:{orderInfo:{Type:Object}},data:function(){return{loading:!1,data:{},table1:{action:"admin/business/sys.salesman.getRewardList",columns:[{key:"userInfo.avatar",title:"用户头像",type:"avatar",width:70,imageWidth:50,shape:"circle"},{key:"group1",title:"基础信息",type:"group",width:250,columns:[{key:"userInfo.nickname",title:"用户昵称",type:"text",width:150},{key:"title",title:"标题",type:"text",width:150},{key:"comment",title:"备注",type:"text",width:150}]},{key:"value",title:"奖励",type:"money",width:100},{key:"is_freeze",title:"状态",type:"tag",width:70,size:"mini",effect:"light",data:[{value:!0,label:"冻结",tagType:"danger"},{value:!1,label:"正常",tagType:"success"}]},{key:"group2",title:"时间信息",type:"group",width:200,columns:[{key:"unfreeze_time",title:"解冻时间",type:"time",width:150},{key:"_add_time",title:"添加时间",type:"time",width:160,sortable:"custom"},{key:"_add_time",title:"距离现在",type:"dateDiff",width:120}]},{key:"reward_type",title:"类型",type:"text",width:90,formatter:function(e,t,n,o){if(0==t.reward_type)return"未分类";if(1==t.reward_type){if(1==t.reward_type_lv)return"直推奖励";if(2==t.reward_type_lv)return"间推奖励"}return 2==t.reward_type?"区域奖励":void 0}},{key:"add_type",title:"添加方式",type:"tag",width:100,size:"small",data:i},{key:"calc_rule",title:"计算规则",type:"object",width:160,columns:[{key:"calc_amount",title:"计算金额",type:"number",width:150,defaultValue:"-"},{key:"reward_value",title:"奖励金额",type:"number",width:150,defaultValue:"-"},{key:"k",title:"奖励比例",type:"percentage",width:150,defaultValue:"-"}]}],selectItem:""},queryForm1:{formData:{no:""},columns:[{key:"no",title:"订单号",type:"text",width:160,mode:"=",hidden:!0}]}}},created:function(){o=this,o.init()},mounted:function(){},methods:{init:function(){o.queryForm1.formData.no=o.orderInfo.order_no||"___"},pageOpen:function(){o=this;var e=o,t=e.value;e.form1,t.item},pageClose:function(){},pageBack:function(){var e=o,t=e.value;t.show=!1,o.$emit("input",t)},search:function(){o.$refs.table1.query(),o.$emit("refresh")},refresh:function(){o.$refs.table1.refresh(),o.$emit("refresh")},getCurrentRow:function(){return o.$refs.table1.getCurrentRow()},currentChange:function(e){o.selectItem=e,o.showOneBtn=!!e},selectionChange:function(e){o.multipleSelection=e}},watch:{},filters:{},computed:{}};t.default=r},"3e1a":function(e,t,n){"use strict";n.r(t);var o=n("5e53"),a=n("5f1b");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"23fc659b",null,!1,o["a"],void 0);t["default"]=u.exports},"3efc":function(e,t,n){"use strict";n.r(t);var o=n("42d8"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},"42d8":function(e,t,n){"use strict";var o;n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;uni.vk;var a={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{page:{title:"修改商家备注",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"7vh",width:"600px"},form1:{data:{_id:"",buyer_remark:"",seller_remark:"",seller_note:""},props:{action:"admin/business/sys.order.updateRemark",columns:[{key:"buyer_remark",title:"买家备注",type:"textarea",placeholder:"无",disabled:!0,autosize:{minRows:5,maxRows:10}},{key:"seller_remark",title:"商家备注",type:"textarea",placeholder:"可在此输入商家备注",autosize:{minRows:5,maxRows:10},maxlength:200,showWordLimit:!0,tips:"此处的商家备注（用户可见）"},{key:"seller_note",title:"商家笔记",type:"textarea",placeholder:"可在此输入商家笔记",autosize:{minRows:5,maxRows:10},maxlength:200,showWordLimit:!0,tips:"此处的商家笔记（用户不可见）"}],rules:{},labelWidth:"100px"}}}},mounted:function(){o=this,o.init()},methods:{init:function(){var e=o,t=e.value;o.$emit("input",t)},onOpen:function(){o=this;var e=o.value.item,t=void 0===e?{}:e;o.form1.data={_id:t._id,buyer_remark:t.buyer_remark,seller_remark:t.seller_remark,seller_note:t.seller_note}},onClose:function(){},onFormSuccess:function(){o.$set(o.value.item,"seller_remark",o.form1.data.seller_remark),o.$set(o.value.item,"seller_note",o.form1.data.seller_note),o.value.show=!1,o.$emit("success")}},watch:{},computed:{}};t.default=a},4352:function(e,t,n){var o=n("b84f");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var a=n("4f06").default;a("6976283a",o,!0,{sourceMap:!1,shadowMode:!1})},"5a10":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("vk-data-drawer",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,center:!0},on:{open:function(t){arguments[0]=t=e.$handleEvent(t),e.onOpen.apply(void 0,arguments)},closed:function(t){arguments[0]=t=e.$handleEvent(t),e.onClose.apply(void 0,arguments)}},scopedSlots:e._u([{key:"footer",fn:function(){return[n("el-button",{staticStyle:{width:"80px"},attrs:{loading:e.page.loading,type:"primary",size:"medium"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}},[e._v(e._s(e.page.submitText))])]},proxy:!0}]),model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[e.orderInfo&&e.orderInfo._id?n("v-uni-view",[n("v-uni-view",{staticStyle:{"max-height":"calc(100vh - 100px - 180px)","overflow-y":"auto"}},[n("el-table",{staticStyle:{width:"100%","margin-top":"0px","margin-bottom":"10px",border:"1px solid #e8e8e8","border-bottom":"0"},attrs:{"show-header":!1,data:e.tableData,"span-method":e.objectSpanMethod,border:!0,"cell-style":e.columnStyle}},[n("el-table-column",{attrs:{width:"180",prop:"title1"}}),n("el-table-column",{attrs:{prop:"value1"},scopedSlots:e._u([{key:"default",fn:function(t){return["订单购买者信息"===t.row.title1?n("v-uni-view",{staticStyle:{display:"flex",height:"40px","line-height":"40px"}},[n("el-image",{staticStyle:{width:"40px",height:"40px","border-radius":"50px"},attrs:{src:e.orderInfo.buyer_info.avatar,"preview-src-list":[e.orderInfo.buyer_info.avatar]}}),n("v-uni-view",{staticStyle:{"margin-left":"20px"}},[e._v(e._s(e.orderInfo.buyer_info.nickname+"（"+e.orderInfo.user_id+"）"))])],1):"状态"===t.row.title1?n("v-uni-view",[n("el-tag",{staticStyle:{"margin-right":"10px"},attrs:{type:"success",effect:"dark",size:"medium"}},[e._v(e._s(e.statusFn(t.row.value1)))]),"wxpay"===e.orderInfo.pay_type?n("el-tag",{attrs:{type:"success",effect:"dark",size:"medium"}},[e._v("微信")]):"alipay"===e.orderInfo.pay_type?n("el-tag",{attrs:{type:"primary",effect:"dark",size:"medium"}},[e._v("支付宝")]):"balance"===e.orderInfo.pay_type?n("el-tag",{attrs:{type:"warning",effect:"dark",size:"medium"}},[e._v("账户余额")]):"offline"===e.orderInfo.pay_type?n("el-tag",{attrs:{type:"info",effect:"dark",size:"medium"}},[e._v("线下支付")]):"none"===e.orderInfo.pay_type?n("el-tag",{attrs:{type:"info",effect:"dark",size:"medium"}},[e._v("无需支付")]):e._e()],1):"快递信息"===t.row.title1?n("v-uni-view",[e.orderInfo.express_no||e.orderInfo.express_name?n("v-uni-view",[e._v(e._s(e.orderInfo.express_no)+"("+e._s(e.orderInfo.express_name)+")")]):n("v-uni-view",[e._v("暂无")])],1):"收货信息"===t.row.title1?n("v-uni-view",[e.orderInfo.express_info.formatted_address||e.orderInfo.express_info.receiver_mobile||e.orderInfo.express_info.receiver_name?n("v-uni-view",[n("v-uni-text",[e._v(e._s(e.orderInfo.express_info.formatted_address))]),n("v-uni-text",{staticStyle:{"margin-left":"6px"}},[e._v(e._s(e.orderInfo.express_info.receiver_mobile))]),n("v-uni-text",{staticStyle:{"margin-left":"6px"}},[e._v(e._s(e.orderInfo.express_info.receiver_name))]),n("v-uni-text",{staticStyle:{"margin-left":"6px","text-decoration":"underline",color:"#409eff",cursor:"pointer"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.copyAddress(e.orderInfo.express_info)}}},[e._v("复制")])],1):n("v-uni-view",[e._v("暂无")])],1):"发货人信息"===t.row.title1?n("v-uni-view",[e.orderInfo.express_info.send_name||e.orderInfo.express_info.send_mobile?n("v-uni-view",[e._v(e._s(e.orderInfo.express_info.send_name)+"( "+e._s(e.orderInfo.express_info.send_mobile)+" )")]):n("v-uni-view",[e._v("暂无")])],1):"优惠信息"===t.row.title1?n("v-uni-view",[e.orderInfo.discount_info.vip_discount_amount?n("v-uni-text",{staticStyle:{display:"inline-block","margin-right":"20px"}},[e._v("会员优惠："+e._s(e.$fn.priceFilter(e.orderInfo.discount_info.vip_discount_amount)))]):e._e(),e.orderInfo.discount_info.integral_discount_amount?n("v-uni-text",{staticStyle:{display:"inline-block","margin-right":"20px"}},[e._v("积分抵扣："+e._s(e.$fn.priceFilter(e.orderInfo.discount_info.integral_discount_amount)))]):e._e()],1):"运费"===t.row.title1?n("v-uni-view",[n("v-uni-text",[e._v(e._s(e.vk.pubfn.priceFilter(e.orderInfo.amount_info.express_amount)))]),e.orderInfo.amount_info.original_express_amount!==e.orderInfo.amount_info.express_amount?n("v-uni-text",{staticStyle:{"font-size":"12px"}},[e._v("（会员优惠至："+e._s(e.vk.pubfn.priceFilter(e.orderInfo.amount_info.original_express_amount))+" - "+e._s(e.vk.pubfn.priceFilter(e.orderInfo.amount_info.original_express_amount-e.orderInfo.amount_info.express_amount))+" = "+e._s(e.vk.pubfn.priceFilter(e.orderInfo.amount_info.express_amount))+"）")]):e._e()],1):n("v-uni-view",{style:t.row.style1},[e._v(e._s(t.row.value1||"--"))])]}}],null,!1,461092854)}),n("el-table-column",{attrs:{width:"180",prop:"title2"}}),n("el-table-column",{attrs:{prop:"value2"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("v-uni-view",{style:t.row.style2},[e._v(e._s(t.row.value2||"--"))])]}}],null,!1,3237795257)})],1)],1),n("v-uni-view",[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.orderInfo.goods_sku_list,"cell-style":{"text-align":"center"},"header-cell-style":{"text-align":"center"},border:!0}},[n("el-table-column",{attrs:{prop:"image",label:"商品图片",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("el-image",{staticStyle:{width:"40px"},attrs:{src:e.row.image,"preview-src-list":[e.row.image]}})]}}],null,!1,763634141)}),n("el-table-column",{attrs:{prop:"goods_name",label:"商品名称","min-width":"250","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[n("v-uni-view",[1==e.orderInfo.order_type?n("el-tag",{staticStyle:{"margin-right":"6px"},attrs:{type:"danger",size:"small"}},[e._v("卡券")]):e._e(),n("v-uni-text",[e._v(e._s(t.row.goods_name))])],1)]}}],null,!1,4268733606)}),n("el-table-column",{attrs:{prop:"sku_name",label:"SKU名称","min-width":"140"}}),n("el-table-column",{attrs:{prop:"real_price",label:"单价（实付）",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("v-uni-view",[e._v(e._s(e.$fn.priceFilter(t.row.real_price)))])]}}],null,!1,718932709)}),n("el-table-column",{attrs:{prop:"buy_num",label:"购买数量",width:"80"}}),n("el-table-column",{attrs:{prop:"should_payment_amount",label:"实付金额",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("v-uni-view",[e._v(e._s(e.$fn.priceFilter(t.row.should_payment_amount)))])]}}],null,!1,2644658674)}),n("el-table-column",{attrs:{prop:"refund_num",label:"退款数量",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("v-uni-view",[e._v(e._s(t.row.refund_num))])]}}],null,!1,3429325828)}),n("el-table-column",{attrs:{prop:"refund_amount",label:"退款金额",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("v-uni-view",[e._v(e._s(e.$fn.priceFilter(t.row.refund_amount)))])]}}],null,!1,4164894704)}),1==e.orderInfo.order_type?n("el-table-column",{attrs:{prop:"verify_num",label:"已核销数量",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("v-uni-text",[e._v(e._s(t.row.verify_num))]),t.row.buy_num-t.row.refund_num===t.row.verify_num?n("el-tag",{staticStyle:{"margin-left":"6px"},attrs:{type:"danger",size:"small"}},[e._v("全核销完")]):e._e()]}}],null,!1,3985368021)}):e._e()],1)],1)],1):e._e()],1)},a=[]},"5e51":function(e,t,n){"use strict";n.r(t);var o=n("0296"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},"5e53":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,mode:"form"},on:{open:function(t){arguments[0]=t=e.$handleEvent(t),e.onOpen.apply(void 0,arguments)},closed:function(t){arguments[0]=t=e.$handleEvent(t),e.onClose.apply(void 0,arguments)}},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[n("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText,"before-action":e.form1.props.beforeAction},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},a=[]},"5f1b":function(e,t,n){"use strict";n.r(t);var o=n("3522"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},6098:function(e,t,n){"use strict";n.r(t);var o=n("3657"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},7204:function(e,t,n){"use strict";n.r(t);var o=n("a94f"),a=n("8584");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"3ea2637a",null,!1,o["a"],void 0);t["default"]=u.exports},7294:function(e,t,n){"use strict";n.r(t);var o=n("17e5"),a=n("da5f");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"559b20c4",null,!1,o["a"],void 0);t["default"]=u.exports},"72c0":function(e,t,n){"use strict";n.r(t);var o=n("c3df"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},"75af":function(e,t,n){"use strict";var o;n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("26e9");var a=uni.vk,i={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{express_info:{express_no:"",express_name:""}}}}}},data:function(){return{page:{title:"物流查询",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"5vh",width:"1000px",expressInfo:[],loading:!1},form1:{data:{},props:{action:"",columns:[{key:"",title:"常用字段类型",type:"bar-title"},{key:"text",title:"text类型",type:"text"},{key:"",title:"选择型字段",type:"bar-title"},{key:"radio",title:"radio类型",type:"radio",data:[{value:1,label:"选项1"},{value:2,label:"选项2"}]}],rules:{},labelWidth:"100px"}}}},mounted:function(){o=this,o.init()},methods:{init:function(){var e=o,t=e.value;o._input(t)},_input:function(e){o.$emit("input",e)},onOpen:function(){var e=this;o=this;var t=o,n=t.value,i=void 0===n?{}:n,r=i.item;o.form1.data=a.pubfn.copyObject(r);var u=i.item.express_info.express_com||"auto";a.callFunction({url:"plugs/express.getInfo",loading:{name:"page.loading",that:o},data:{com:u,no:i.item.express_info.express_no},success:function(t){e.page.expressInfo=t.data}})},onClose:function(){this.page.expressInfo.data=[]},open:function(){var e=o,t=e.value;t.show=!0,o._input(t)},close:function(){var e=o,t=e.value;t.show=!1,o._input(t)}},watch:{},computed:{dataCom:function(){var e=this.page,t=a.pubfn.getData(e,"expressInfo.data");return t=t?t.reverse():[],t}}};t.default=i},"78ce":function(e,t,n){"use strict";var o=n("f335"),a=n.n(o);a.a},"796f":function(e,t,n){"use strict";var o=n("4352"),a=n.n(o);a.a},8133:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("vk-data-drawer",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"show-header":!1},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[e.value.item&&e.value.show?n("v-uni-view",[n("v-uni-view",{staticStyle:{display:"flex","align-items":"center",padding:"0 10px"}},[n("v-uni-view",{staticStyle:{flex:"1"}},[n("v-uni-text",[e._v("订单号："+e._s(e.value.item.order_no))]),n("v-uni-text",{staticStyle:{"margin-left":"20px"}},[e._v("付款金额："+e._s(e.vk.pubfn.priceFilter(e.value.item.amount_info.payment_amount)))]),n("v-uni-text",{staticStyle:{"margin-left":"20px"}},[e._v("退款金额："+e._s(e.vk.pubfn.priceFilter(e.value.item.amount_info.refund_amount)))])],1),n("v-uni-view",{staticStyle:{"text-align":"right","font-size":"25px",cursor:"pointer"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}},[e._v("×")])],1),n("v-uni-view",{staticStyle:{padding:"15px"}},[n("el-tabs",{attrs:{type:"card"},model:{value:e.pageName,callback:function(t){e.pageName=t},expression:"pageName"}},e._l(e.tabs,(function(e,t){return n("el-tab-pane",{key:t,attrs:{label:e.title,name:e.name}})})),1),n("keep-alive",[n(e.pageName,{tag:"component",attrs:{orderInfo:e.value.item}})],1)],1)],1):e._e()],1)},a=[]},"819a":function(e,t,n){"use strict";n.r(t);var o=n("dd35"),a=n("3efc");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"043dc251",null,!1,o["a"],void 0);t["default"]=u.exports},"81ac":function(e,t,n){"use strict";var o;n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("d81d");var a=uni.vk,i={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:"",options:""}}}},data:function(){return{loading:!1,refundInfo:{images:[],refund_desc:"",goods_list:[]},page:{title:"退款审核",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"5vh",width:"900px"},form1:{data:{_id:"",type:1,refund_express_amount:0,refund_amount:"",out_refund_no:"",status_msg:"",goods_list:[],express_name:"",express_no:""},props:{action:"admin/business/sys.order.orderRefundExamine",columns:[{key:"buyer_info",title:"买家信息",type:"userInfo"},{key:"refund_info",title:"",type:"text-view",showLabel:!1},{key:"goods_list",title:"退款商品",type:"text",showLabel:!1},{key:"refund_express_amount",title:"退运费金额",type:"money",width:200},{key:"refund_amount",title:"合计退款",type:"money-view",tips:"若同意退款，则资金会原路返回"},{key:"type",title:"处理结果",type:"radio",data:[{value:1,label:"同意退款"},{value:2,label:"拒绝退款"}]},{key:"status_msg",title:"备注",type:"textarea",showRule:"type==1",autosize:{minRows:4,maxRows:10},maxlength:200,showWordLimit:!0},{key:"status_msg",title:"拒绝原因",type:"textarea",showRule:"type==2",autosize:{minRows:4,maxRows:10},maxlength:200,showWordLimit:!0}],rules:{},labelWidth:"100px"}}}},mounted:function(){o=this,o.init()},methods:{init:function(){var e=o,t=e.value;o._input(t)},_input:function(e){o.$emit("input",e)},onOpen:function(){o=this;var e=o,t=e.value,n=void 0===t?{}:t,i=n.item;a.callFunction({url:"admin/business/sys.order.getRefundOrder",loading:{that:o,name:"loading"},data:{_id:i._id},success:function(e){var t=e.info;o.refundInfo=t,o.form1.data._id=i._id,o.form1.data.refund_amount=t.refund_amount,o.form1.data.refund_goods_amount=t.refund_goods_amount,o.form1.data.refund_express_amount=t.refund_express_amount,o.form1.data.out_refund_no=t.out_refund_no,o.form1.data.status_msg=t.status_msg,o.form1.data.express_name=t.express_name,o.form1.data.express_no=t.express_no,o.form1.data.goods_list=t.goods_list.map((function(e,t){var n=a.pubfn.getListItem(o.value.item.goods_sku_list,"_id",e.sku_id);return{sku_id:e.sku_id,refund_num:e.refund_num,refund_amount:e.refund_amount,goods_id:n.goods_id,image:n.image,goods_name:n.goods_name,sku_name:n.sku_name}}))}})},onClose:function(){o.resetForm()},onFormSuccess:function(e){o.close(),a.pubfn.objectAssignForVue(o.value.item,e.data.orderInfo,o),o.$emit("success")},open:function(){var e=o,t=e.value;t.show=!0,o._input(t)},close:function(){var e=o,t=e.value;t.show=!1,o._input(t)},resetForm:function(){o.$refs.form1.resetForm()},submitForm:function(){o.$refs.form1.submitForm()},maxRefundNum:function(e){var t=e.sku_id,n=a.pubfn.getListItem(this.value.item.goods_sku_list,"_id",t),o=n.buy_num,i=n.refund_num,r=void 0===i?0:i;return o-r},maxRefundAmount:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this,o=e.sku_id,i=e.refund_num,r=a.pubfn.getListItem(n.value.item.goods_sku_list,"_id",o),u=r.real_price,s=r.should_payment_amount,l=void 0===s?0:s,d=r.refund_amount,c=void 0===d?0:d,f=l-c,m=0;return m=1===t?a.pubfn.toDecimal(u*i/100,2):a.pubfn.toDecimal(u*i,0),m>f&&(m=f),m},refundNumChange:function(e,t){t.sku_id;var n=this.maxRefundAmount(t);t.refund_amount=n},maxRefundExpressAmountFn:function(e){var t=this.value.item;return 0==e?a.pubfn.toDecimal(t.amount_info.express_amount-t.amount_info.refund_express_amount,0):a.pubfn.toDecimal((t.amount_info.express_amount-t.amount_info.refund_express_amount)/100,2)},onlyRefundFreight:function(){var e=this;e.form1.data.goods_list.map((function(t,n){t.refund_num=0,e.refundNumChange(0,t)})),e.form1.data.refund_express_amount||(e.form1.data.refund_express_amount=e.maxRefundExpressAmountFn(0))}},watch:{},computed:{totalRefundGoodsAmountCom:function(){var e=0;return this.form1.data.goods_list.map((function(t,n){e+=t.refund_amount})),e},totalRefundAmountCom:function(){return this.totalRefundGoodsAmountCom+this.form1.data.refund_express_amount}}};t.default=i},8341:function(e,t,n){"use strict";n.r(t);var o=n("c21e"),a=n("1b80");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"406d4292",null,!1,o["a"],void 0);t["default"]=u.exports},8348:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.value.item.express_info.express_name&&e.value.item.express_info.express_no?n("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,center:!0,mode:"form","close-on-click-modal":!0},on:{open:function(t){arguments[0]=t=e.$handleEvent(t),e.onOpen.apply(void 0,arguments)},closed:function(t){arguments[0]=t=e.$handleEvent(t),e.onClose.apply(void 0,arguments)}},scopedSlots:e._u([{key:"footer",fn:function(){return[n("v-uni-view",[n("el-button",{staticStyle:{width:"100px"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.value.show=!1}}},[e._v("关闭")])],1)]},proxy:!0}],null,!1,1561584726),model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[n("v-uni-view",{staticStyle:{margin:"20px 30px 30px 30px","overflow-y":"auto","max-height":"700px"}},[n("el-form",{staticClass:"demo-form-inline",staticStyle:{"letter-spacing":"2px"},attrs:{inline:!0,model:e.form1}},[n("el-form-item",[n("v-uni-image",{staticStyle:{width:"100px"},attrs:{src:e.page.expressInfo.logo,mode:"widthFix"}})],1),n("el-form-item",[n("v-uni-text",{staticStyle:{"font-size":"28rpx"}},[e._v("快递公司：")]),n("v-uni-text",{staticStyle:{"font-weight":"bold","font-size":"28rpx",color:"red"}},[e._v(e._s(e.value.item.express_info.express_name))])],1),n("el-form-item",[n("v-uni-text",{staticStyle:{"font-size":"28rpx"}},[e._v("快递单号：")]),n("v-uni-text",{staticStyle:{"font-weight":"bold","font-size":"28rpx",color:"red"}},[e._v(e._s(e.value.item.express_info.express_no))])],1),n("el-form-item",[n("v-uni-text",{staticStyle:{"font-size":"28rpx"}},[e._v("快递客服电话：")]),n("v-uni-text",{staticStyle:{"font-weight":"bold","font-size":"28rpx",color:"red"}},[e._v(e._s(e.page.expressInfo.tel))])],1)],1),n("v-uni-view",{directives:[{name:"loading",rawName:"v-loading",value:e.page.loading,expression:"page.loading"}],staticStyle:{"min-height":"60vh"}},[0!=e.page.expressInfo.dataSize?n("v-uni-view",{staticStyle:{height:"600px"}},[n("el-steps",{staticStyle:{"font-size":"28rpx"},attrs:{direction:"vertical",active:e.dataCom.length-1,space:"60px","finish-status":"wait","process-status":"finish"}},e._l(e.dataCom,(function(e,t){return n("el-step",{key:t,attrs:{title:e.context,description:e.time}})})),1)],1):n("v-uni-view",{staticStyle:{"line-height":"60vh",width:"100%",height:"600px"}},[n("v-uni-view",{staticStyle:{"font-size":"36px","text-align":"center",color:"#dcdfe3"}},[e._v("查无记录")])],1)],1)],1)],1):e._e()},a=[]},8584:function(e,t,n){"use strict";n.r(t);var o=n("81ac"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},"8a45":function(e,t,n){"use strict";n("7a82");var o=n("ee27").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=o(n("3372")),r=o(n("8341")),u=(uni.vk,{components:{userReward:i.default,userPerformance:r.default},props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:"",options:"",pageName:""}}}},data:function(){return{pageName:"user-reward",tabs:[{title:"奖励明细",name:"user-reward"},{title:"业绩明细",name:"user-performance"}],page:{title:"标题",top:"7vh",width:"1300px",loading:!1}}},mounted:function(){a=this,a.init()},methods:{init:function(){var e=a,t=e.value;a._input(t)},_input:function(e){a.$emit("input",e)},onOpen:function(){a=this;var e=a,t=e.value,n=void 0===t?{}:t;n.item;a.pageName=a.value.pageName||"user-reward"},onClose:function(){},open:function(){var e=a,t=e.value;t.show=!0,a._input(t)},close:function(){var e=a,t=e.value;t.show=!1,a._input(t)}},watch:{"value.show":{handler:function(e,t){e?this.onOpen():this.onClose()}}},computed:{}});t.default=u},"99cd":function(e,t,n){"use strict";n.r(t);var o=n("2106"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},"9c51":function(e,t,n){"use strict";n.r(t);var o=n("75af"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},"9efd":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[n("vk-data-table",{ref:"table1",attrs:{action:e.table1.action,columns:e.table1.columns,"query-form-param":e.queryForm1,"right-btns":["detail_auto"],"left-fixed":!1,"right-fixed":!1,selection:!1,"row-no":!0,pagination:!0,size:"mini"},on:{"current-change":function(t){arguments[0]=t=e.$handleEvent(t),e.currentChange.apply(void 0,arguments)},"selection-change":function(t){arguments[0]=t=e.$handleEvent(t),e.selectionChange.apply(void 0,arguments)}},scopedSlots:e._u([{key:"calc_rule",fn:function(t){var o=t.row;t.column,t.index;return[4===o.add_type?n("v-uni-view",[n("v-uni-view",[e._v("奖励金额："+e._s(o.calc_rule.calc_amount))]),n("v-uni-view",[e._v("扣回奖励："+e._s(o.calc_rule.reward_value))]),n("v-uni-view",[e._v("扣回占比："+e._s(e.vk.pubfn.percentageFilter(o.calc_rule.k)))])],1):4===o.add_type?n("v-uni-view",[n("v-uni-view",[e._v("商品金额："+e._s(o.calc_rule.calc_amount))]),n("v-uni-view",[e._v("奖励金额："+e._s(o.calc_rule.reward_value))]),n("v-uni-view",[e._v("奖励占比："+e._s(e.vk.pubfn.percentageFilter(o.calc_rule.k)))])],1):e._e()]}}])})],1)},a=[]},a05c:function(e,t,n){"use strict";n.r(t);var o=n("8133"),a=n("0b2a");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"d7566756",null,!1,o["a"],void 0);t["default"]=u.exports},a1c53:function(e,t,n){"use strict";var o;n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=uni.vk,i=a.getVuex("$app.config.maill.rec.addType"),r={props:{orderInfo:{Type:Object}},data:function(){return{loading:!1,data:{},table1:{action:"admin/business/sys.salesman.getGoodsPerList",columns:[{key:"userInfo.avatar",title:"用户头像",type:"avatar",width:70,imageWidth:50,shape:"circle"},{key:"group1",title:"基础信息",type:"group",width:260,columns:[{key:"userInfo.nickname",title:"用户昵称",type:"text",width:150},{key:"title",title:"标题",type:"text",width:150},{key:"no",title:"订单号",type:"text",width:250}]},{key:"amount.goods_payment_amount",title:"出货业绩",type:"money",width:120,defaultValue:"-"},{key:"amount.refund_goods_payment_amount",title:"退货业绩",type:"money",width:120,defaultValue:"-"},{key:"add_type",title:"添加方式",type:"tag",width:140,size:"small",data:i},{key:"group2",title:"时间信息",type:"group",width:200,columns:[{key:"_add_time",title:"添加时间",type:"time",width:180,defaultValue:"-"},{key:"pay_time",title:"付款时间",type:"time",width:180,defaultValue:"-"},{key:"refund_time",title:"退款时间",type:"time",width:180,defaultValue:"-"}]}],multipleSelection:[],selectItem:""},queryForm1:{formData:{no:""},columns:[{key:"no",title:"订单号",type:"text",width:160,mode:"=",hidden:!0}]}}},created:function(){o=this,o.init()},mounted:function(){},methods:{init:function(){o.queryForm1.formData.no=o.orderInfo.order_no||"___"},pageOpen:function(){o=this;var e=o,t=e.value;e.form1,t.item},pageClose:function(){},pageBack:function(){var e=o,t=e.value;t.show=!1,o.$emit("input",t)},search:function(){o.$refs.table1.query(),o.$emit("refresh")},refresh:function(){o.$refs.table1.refresh(),o.$emit("refresh")},getCurrentRow:function(){return o.$refs.table1.getCurrentRow()},currentChange:function(e){o.selectItem=e,o.showOneBtn=!!e},selectionChange:function(e){o.multipleSelection=e}},watch:{},filters:{},computed:{}};t.default=r},a22c8:function(e,t,n){var o=n("24fb");t=o(!1),t.push([e.i,".group-badge[data-v-77a9abed]  .el-badge__content.is-fixed{z-index:2;right:20px;text-align:right}",""]),e.exports=t},a27f:function(e,t,n){"use strict";n.r(t);var o=n("b118"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},a860:function(e,t,n){"use strict";n.r(t);var o=n("2c30"),a=n("72c0");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"325d9108",null,!1,o["a"],void 0);t["default"]=u.exports},a8a0:function(e,t,n){"use strict";var o;n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("d81d"),n("c975"),n("99af");var a=uni.vk,i={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{loading:!1,page:{title:"发货",submitText:"发 货",cancelText:"关 闭",showCancel:!0,top:"7vh",width:"800px"},form1:{data:{_id:"",order_no:"",express_com:"",express_name:"",express_no:"",send_name:"",position:"",tips:["发送短信提醒"],send_mobile:"",goods_sku_list:[]},props:{action:"admin/business/sys.order.orderSend",columns:[{key:"order_no",title:"订单号",type:"text-view"},{key:"addressInfo",title:"收货信息",type:"text"},{key:"express_name",title:"快递公司",type:"remote-select",placeholder:"请选择快递公司",action:"admin/business/sys.expressCo.kh_getList",props:{list:"rows",value:"name",label:"name"},showAll:!0,watch:function(e){a.setVuex("$user.expressName",e.option.name)}},{key:"express_no",title:"快递单号",type:"text",tips:"可以安装扫码枪，扫码快递单，自动填写单号。"},{key:"send_name",title:"发货人姓名",type:"text"},{key:"send_mobile",title:"发货人手机",type:"text"},{key:"tips",title:"操作",type:"checkbox",data:[{value:"发送短信提醒",label:"发送短信提醒"},{value:"更新发货时间",label:"更新发货时间"}]},{key:"goods_sku_list",title:"发货详情",type:"array<object>",showLabel:!1,minItemWidth:200,showAdd:!1,columns:[{key:"goods_name",title:"产品名称",type:"text-view",minWidth:200},{key:"buy_num",title:"购买数量",type:"text-view",minWidth:150},{key:"send_num",title:"已发数量",type:"number",clearable:!1,minWidth:150,rules:[{required:!0,message:"该项不能为空",trigger:["blur"]}]}]}],rules:{express_name:[{required:!0,message:"快递名称为必选项",trigger:"blur"}],express_no:[{required:!0,message:"订单号为必填项",trigger:"blur"}]},labelWidth:"100px"}},orderInfo:{express_info:{}}}},mounted:function(){o=this,o.init()},methods:{init:function(){var e=o,t=e.value;o.$emit("input",t)},onOpen:function(){o=this;var e=o.value.item,t=void 0===e?{}:e,n=a.getVuex("$user.userInfo");o.orderInfo=t,2===o.orderInfo.delivery_mode?o.form1.props.rules.express_no=[]:o.form1.props.rules.express_no=[{required:!0,message:"订单号为必填项",trigger:"blur"}],a.pubfn.objectAssign(o.form1.data,a.pubfn.copyObject({_id:t._id,order_no:t.order_no,express_com:t.express_info.express_com,express_name:t.express_info.express_name||a.getVuex("$user.expressName"),express_no:t.express_info.express_no||"",send_name:t.express_info.send_name||n.nickname,position:t.express_info.position.address,tips:["发送短信提醒","发送订阅消息"],send_mobile:t.express_info.send_mobile})),setTimeout((function(){o.$refs.express_no&&!o.form1.data.express_no&&o.$refs.express_no.focus()}),300),o.form1.data.goods_sku_list=t.goods_sku_list.map((function(e,t){return{buy_num:e.buy_num,max_send_num:e.buy_num-e.refund_num,send_num:e.send_num,goods_name:e.goods_name,_id:e._id,goods_id:e.goods_id,image:e.image,sku_name:e.sku_name}})),[1,2].indexOf(t.status)>-1&&o.allinSend()},allinSend:function(){o.form1.data.goods_sku_list.map((function(e,t){e.max_send_num!=e.send_num&&(e.send_num=e.max_send_num)}))},onClose:function(){},onFormSuccess:function(e){o.value.show=!1,-1==[3,4].indexOf(e.data.orderInfo.status)&&a.alert(e.data.msg,"发货失败","我知道了"),a.pubfn.objectAssignForVue(o.value.item,e.data.orderInfo,o),o.$emit("success")},copyAddress:function(e){var t="".concat(e.formatted_address," ").concat(e.receiver_mobile," ").concat(e.receiver_name);uni.setClipboardData({data:t,success:function(){a.toast("地址复制成功")}})}},watch:{},computed:{allSendDisabled:function(){var e=0,t=this.form1.data.goods_sku_list||[];return t.map((function(t,n){t.max_send_num===t.send_num&&e++})),e===t.length},submitDisabledCom:function(){var e=0,t=this.form1.data.goods_sku_list||[],n=!1;return t.map((function(t,o){"number"===typeof t.send_num?e+=t.send_num:n=!0})),!(0!==e&&!n)}}};t.default=i},a94f:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,mode:"form"},on:{open:function(t){arguments[0]=t=e.$handleEvent(t),e.onOpen.apply(void 0,arguments)},closed:function(t){arguments[0]=t=e.$handleEvent(t),e.onClose.apply(void 0,arguments)}},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[n("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},scopedSlots:e._u([{key:"buyer_info",fn:function(t){t.form,t.keyName;return[n("v-uni-view",{staticStyle:{height:"36px",display:"flex","align-items":"center"}},[n("v-uni-image",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:e.value.item.buyer_info.avatar,mode:"aspectFill"}}),n("v-uni-view",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.value.item.buyer_info.nickname))])],1)]}},{key:"refund_info",fn:function(t){t.form,t.keyName;return[n("v-uni-view",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{padding:"0 30px"}},[n("v-uni-view",[n("v-uni-text",[e._v("申请时间")]),n("v-uni-text",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.vk.pubfn.timeFormat(e.refundInfo.apply_refund_time)))])],1),n("v-uni-view",[n("v-uni-text",[e._v("退款原因")]),n("v-uni-text",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.refundInfo.refund_reason))])],1),n("v-uni-view",[n("v-uni-text",[e._v("用户留言")]),n("v-uni-text",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.refundInfo.refund_desc||"无"))])],1),e.refundInfo.express_name?n("v-uni-view",[n("v-uni-text",[e._v("寄回的快递公司")]),n("v-uni-text",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.refundInfo.express_name||"无"))])],1):e._e(),e.refundInfo.express_no?n("v-uni-view",[n("v-uni-text",[e._v("寄回的快递单号")]),n("v-uni-text",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.refundInfo.express_no||"无"))])],1):e._e(),e._l(e.refundInfo.images,(function(t,o){return n("el-image",{key:o,staticStyle:{height:"60px",margin:"4px",padding:"2px",border:"1px solid #bbbbbb"},attrs:{mode:"widthFix",src:t,"preview-src-list":e.refundInfo.images}})})),e.refundInfo.images&&e.refundInfo.images.length>0?n("vk-data-tips",{attrs:{tips:"点击任意图片，可进行预览"}}):e._e()],2)]}},{key:"goods_list",fn:function(t){var o=t.form,a=t.keyName;return[n("v-uni-view",{staticStyle:{"text-align":"center","font-weight":"bold","font-size":"17px"}},[e._v("本次退款商品列表")]),n("el-table",{staticStyle:{width:"100%"},attrs:{data:o[a],border:!0}},[n("el-table-column",{attrs:{prop:"image",label:"商品封面",width:"100"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;e.column,e.$index;return[n("v-uni-image",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:t.image,mode:"aspectFill"}})]}}],null,!0)}),n("el-table-column",{attrs:{prop:"goods_name",label:"商品名称",minWidth:"100"}}),n("el-table-column",{attrs:{prop:"sku_name",label:"规格",minWidth:"100"}}),n("el-table-column",{attrs:{prop:"refund_num",label:"申请退款数量",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;t.column,t.$index;return[n("vk-data-input-number-box",{attrs:{precision:0,step:1,"controls-position":"right",max:e.maxRefundNum(o),width:"90px",size:"small"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.refundNumChange(t,o)}},model:{value:o.refund_num,callback:function(t){e.$set(o,"refund_num",t)},expression:"row.refund_num"}})]}}],null,!0)}),n("el-table-column",{attrs:{prop:"refund_amount",label:"申请退款金额",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;t.column,t.$index;return[n("vk-data-input-money",{attrs:{precision:2,disabled:0==e.maxRefundAmount(o,1),max:e.maxRefundAmount(o,1),width:"90px",size:"small",clearable:!1},model:{value:o.refund_amount,callback:function(t){e.$set(o,"refund_amount",t)},expression:"row.refund_amount"}})]}}],null,!0)})],1)]}},{key:"refund_express_amount",fn:function(t){var o=t.form,a=t.keyName;return[n("vk-data-input-money",{attrs:{precision:2,max:e.maxRefundExpressAmountFn(1),width:"90px",size:"small",clearable:!1},model:{value:o[a],callback:function(t){e.$set(o,a,t)},expression:"form[keyName]"}}),n("v-uni-text",{staticStyle:{"margin-left":"10px","text-decoration":"underline",color:"#409eff",cursor:"pointer"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),o[a]=e.maxRefundExpressAmountFn(0)}}},[e._v("退全部运费")]),n("v-uni-text",{staticStyle:{"margin-left":"30px","text-decoration":"underline",color:"#409eff",cursor:"pointer"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onlyRefundFreight.apply(void 0,arguments)}}},[e._v("只退运费")]),n("vk-data-tips",{attrs:{tips:"最多可退 "+e.maxRefundExpressAmountFn(1)+" 元运费"}})]}},{key:"refund_amount",fn:function(t){t.form,t.keyName;return[n("v-uni-view",{staticStyle:{"font-size":"17px","font-weight":"bold",color:"red"}},[e._v(e._s(e.vk.pubfn.priceFilter(e.totalRefundAmountCom)))]),n("vk-data-tips",{attrs:{tips:"若同意退款，则资金会原路返回"}})]}}]),model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},a=[]},b096:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,mode:"form"},on:{open:function(t){arguments[0]=t=e.$handleEvent(t),e.onOpen.apply(void 0,arguments)},closed:function(t){arguments[0]=t=e.$handleEvent(t),e.onClose.apply(void 0,arguments)}},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[n("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"max-height":"700px","show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},scopedSlots:e._u([{key:"express_amount",fn:function(t){var o=t.form;t.keyName;return[o.goods_sku_list?n("v-uni-view",{staticStyle:{display:"flex"}},[n("v-uni-view",[e._v("订单运费："+e._s(e.vk.pubfn.toDecimal(e.form1.data.express_amount/100,2))+" 元")]),n("v-uni-view",{staticStyle:{"margin-left":"40px"}},[n("v-uni-text",[e._v("商家优惠：")]),n("vk-data-input-money",{attrs:{max:e.vk.pubfn.toDecimal(e.form1.data.express_amount/100,2),precision:0,disabled:e.form1.data.express_amount<=0,placeholder:"请输入金额",width:"180px",rightText:"元"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.calcData.apply(void 0,arguments)}},model:{value:e.form1.data.business_discount_express_amount,callback:function(t){e.$set(e.form1.data,"business_discount_express_amount",t)},expression:"form1.data.business_discount_express_amount"}})],1),n("v-uni-view",{staticStyle:{"margin-left":"40px"}},[n("v-uni-text",[e._v("优惠后运费：")]),n("v-uni-text",{staticStyle:{color:"red","font-weight":"bold"}},[e._v(e._s(e.vk.pubfn.toDecimal(e.form1.data.expressAmount/100,2))+" 元")])],1)],1):e._e()]}},{key:"total",fn:function(t){var o=t.form;t.keyName;return[o.goods_sku_list?n("v-uni-view",{staticStyle:{display:"flex"}},[n("v-uni-view",[n("v-uni-text",[e._v("商品数量：")]),n("v-uni-text",{staticStyle:{color:"red","font-weight":"bold"}},[e._v(e._s(e.form1.data.goodsNum))])],1),n("v-uni-view",{staticStyle:{"margin-left":"40px"}},[n("v-uni-text",[e._v("商家商品减价：")]),n("v-uni-text",{staticStyle:{color:"red","font-weight":"bold"}},[e._v(e._s(e.vk.pubfn.priceFilter(e.form1.data.businessDiscountAmount)))])],1),n("v-uni-view",{staticStyle:{"margin-left":"40px"}},[n("v-uni-text",[e._v("实付金额：")]),n("v-uni-text",{staticStyle:{color:"red","font-weight":"bold"}},[e._v(e._s(e.vk.pubfn.priceFilter(e.form1.data.paymentAmount)))])],1)],1):e._e()]}}]),model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},a=[]},b118:function(e,t,n){"use strict";var o;n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("d81d");var a=uni.vk,i={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:"",options:""}}}},data:function(){return{loading:!1,page:{title:"订单主动退款",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"5vh",width:"680px"},form1:{data:{_id:"",status_msg:"",refund_amount:0},props:{action:"admin/business/sys.order.activityOrderRefund",columns:[{key:"buyer_info",title:"买家信息",type:"userInfo"},{key:"refund_amount",title:"退款金额",type:"money"},{key:"status_msg",title:"备注",type:"textarea",autosize:{minRows:4,maxRows:10},maxlength:200,showWordLimit:!0}],rules:{},labelWidth:"100px"}}}},mounted:function(){o=this,o.init()},methods:{init:function(){var e=o,t=e.value;o._input(t)},_input:function(e){o.$emit("input",e)},onOpen:function(){o=this;var e=o,t=e.value,n=void 0===t?{}:t,a=n.item;o.form1.data._id=a._id},onClose:function(){o.resetForm()},onFormSuccess:function(e){o.close(),a.pubfn.objectAssignForVue(o.value.item,e.data.orderInfo,o),o.$emit("success")},open:function(){var e=o,t=e.value;t.show=!0,o._input(t)},close:function(){var e=o,t=e.value;t.show=!1,o._input(t)},resetForm:function(){o.$refs.form1.resetForm()},submitForm:function(){o.$refs.form1.submitForm()},maxRefundNum:function(e){var t=e.sku_id,n=a.pubfn.getListItem(this.value.item.goods_sku_list,"_id",t),o=n.buy_num,i=n.refund_num,r=void 0===i?0:i;return o-r},maxRefundAmount:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this,o=e.sku_id,i=e.refund_num,r=a.pubfn.getListItem(n.value.item.goods_sku_list,"_id",o),u=r.real_price,s=r.should_payment_amount,l=void 0===s?0:s,d=r.refund_amount,c=void 0===d?0:d,f=l-c,m=0;return m=1===t?a.pubfn.toDecimal(u*i/100,2):a.pubfn.toDecimal(u*i,0),m>f&&(m=f),m},refundNumChange:function(e,t){t.sku_id;var n=this.maxRefundAmount(t);t.refund_amount=n},maxRefundExpressAmountFn:function(e){var t=this.value.item;return 0==e?a.pubfn.toDecimal(t.amount_info.express_amount-t.amount_info.refund_express_amount,0):a.pubfn.toDecimal((t.amount_info.express_amount-t.amount_info.refund_express_amount)/100,2)},onlyRefundFreight:function(){var e=this;e.form1.data.goods_list.map((function(t,n){t.refund_num=0,e.refundNumChange(0,t)})),e.form1.data.refund_express_amount||(e.form1.data.refund_express_amount=e.maxRefundExpressAmountFn(0))}},watch:{},computed:{totalRefundGoodsAmountCom:function(){var e=0;return this.form1.data.goods_list.map((function(t,n){e+=t.refund_amount})),e},totalRefundAmountCom:function(){return this.totalRefundGoodsAmountCom+this.form1.data.refund_express_amount}}};t.default=i},b84f:function(e,t,n){var o=n("24fb");t=o(!1),t.push([e.i,"[data-v-4748db30] .el-step__title{font-size:14px}",""]),e.exports=t},c21e:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[n("vk-data-table",{ref:"table1",attrs:{action:e.table1.action,columns:e.table1.columns,"query-form-param":e.queryForm1,"right-btns":["detail_auto"],"left-fixed":!1,"right-fixed":!1,selection:!1,"row-no":!0,pagination:!0,size:"mini"},on:{"current-change":function(t){arguments[0]=t=e.$handleEvent(t),e.currentChange.apply(void 0,arguments)},"selection-change":function(t){arguments[0]=t=e.$handleEvent(t),e.selectionChange.apply(void 0,arguments)}}})],1)},a=[]},c3df:function(e,t,n){"use strict";var o;n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=uni.vk,i={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{page:{title:"修改收货信息",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"7vh",width:"500px"},form1:{data:{address:"",receiver_name:"",receiver_mobile:"",codes:[]},props:{action:"admin/business/sys.order.updateReceiverInfo",columns:[{key:"position",title:"地址",type:"address"},{key:"address",title:"街道地址信息",type:"text"},{key:"receiver_name",title:"收货人姓名",type:"text"},{key:"receiver_mobile",title:"收货人手机号",type:"text"}],rules:{receiver_mobile:[{validator:a.pubfn.validator("mobile"),message:"手机号格式错误",trigger:"blur"}]},labelWidth:"100px"}}}},mounted:function(){o=this,o.init()},methods:{init:function(){var e=o,t=e.value;o.$emit("input",t)},onOpen:function(){o=this;var e=o.value.item,t=void 0===e?{}:e;o.form1.data={_id:t._id,position:t.express_info.position,address:t.express_info.position.address,receiver_name:t.express_info.receiver_name,receiver_mobile:t.express_info.receiver_mobile}},onClose:function(){},onFormSuccess:function(e){o.value.show=!1,e.data.info&&(o.value.item.express_info=e.data.info.express_info),o.$emit("success")}},watch:{},computed:{}};t.default=i},da5f:function(e,t,n){"use strict";n.r(t);var o=n("a8a0"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},dd35:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,mode:"form"},on:{open:function(t){arguments[0]=t=e.$handleEvent(t),e.onOpen.apply(void 0,arguments)},closed:function(t){arguments[0]=t=e.$handleEvent(t),e.onClose.apply(void 0,arguments)}},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[n("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},a=[]},ddd7:function(e,t,n){"use strict";n.r(t);var o=n("b096"),a=n("99cd");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"ec5491ae",null,!1,o["a"],void 0);t["default"]=u.exports},dfbe:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,mode:"form"},on:{open:function(t){arguments[0]=t=e.$handleEvent(t),e.onOpen.apply(void 0,arguments)},closed:function(t){arguments[0]=t=e.$handleEvent(t),e.onClose.apply(void 0,arguments)}},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[n("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},scopedSlots:e._u([{key:"buyer_info",fn:function(t){t.form,t.keyName;return[n("v-uni-view",{staticStyle:{height:"36px",display:"flex","align-items":"center"}},[n("v-uni-image",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:e.value.item.buyer_info.avatar,mode:"aspectFill"}}),n("v-uni-view",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.value.item.buyer_info.nickname))])],1)]}}]),model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},a=[]},e100:function(e,t,n){"use strict";n.r(t);var o=n("1fef"),a=n("5e51");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("78ce");var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"77a9abed",null,!1,o["a"],void 0);t["default"]=u.exports},e37f:function(e,t,n){"use strict";n.r(t);var o=n("8348"),a=n("9c51");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("796f");var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"4748db30",null,!1,o["a"],void 0);t["default"]=u.exports},e96f:function(e,t,n){"use strict";var o;n("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("c975"),n("99af");var a=uni.vk,i=a.getVuex("$app.config.maill.order.status"),r={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:"",options:""}}}},data:function(){return{page:{title:"订单详情",submitText:"关 闭",top:"2vh",width:"1200px",loading:!1},orderInfo:{}}},mounted:function(){o=this,o.init()},methods:{init:function(){var e=o,t=e.value;o._input(t)},_input:function(e){o.$emit("input",e)},onOpen:function(){o=this;var e=o,t=e.value,n=void 0===t?{}:t,i=n.item;o.orderInfo=a.pubfn.copyObject(i)},onClose:function(){},open:function(){var e=o,t=e.value;t.show=!0,o._input(t)},close:function(){var e=o,t=e.value;t.show=!1,o._input(t)},columnStyle:function(e){e.row,e.column,e.rowIndex;var t=e.columnIndex;return 0===t||2===t||4===t?"background:#f8f8f8;text-align:center":"background:#ffffff;text-align:center"},objectSpanMethod:function(e){e.row,e.column;var t=e.rowIndex,n=e.columnIndex;if([6,7,8,9,10,11,12].indexOf(t)>-1){if(1===n)return[1,3];if(2===n||3===n)return[0,0]}},statusFn:function(){return i[this.orderInfo.status]},copyAddress:function(e){var t="".concat(e.formatted_address," ").concat(e.receiver_mobile," ").concat(e.receiver_name);uni.setClipboardData({data:t,success:function(){a.toast("地址复制成功")}})}},watch:{},computed:{tableData:function(){var e=this.vk,t=this.orderInfo;return[{title1:"订单购买者信息",value1:t.user_avatar||"--",title2:"订单id",value2:t._id||"--"},{title1:"状态",value1:t.status||"暂无",title2:"订单号",value2:t.order_no||"--"},{title1:"订单原价",value1:e.pubfn.priceFilter(t.amount_info.total_amount),title2:"商品原价",value2:e.pubfn.priceFilter(t.amount_info.goods_amount)},{title1:"运费",value1:e.pubfn.priceFilter(t.amount_info.express_amount),title2:"合计优惠",value2:e.pubfn.priceFilter(t.discount_info.total_discount)},{title1:"订单应付",value1:e.pubfn.priceFilter(t.amount_info.should_payment_amount),title2:"商品折扣",value2:e.pubfn.discountFilter(t.discount_info.real_discount)},{title1:"使用余额",value1:e.pubfn.priceFilter(t.amount_info.used_balance_amount),title2:"使用现金",value2:e.pubfn.priceFilter(t.amount_info.used_cash_amount)},{title1:"买家备注",value1:t.buyer_remark||"暂无",title2:"占位符",value2:"占位符"},{title1:"商家备注信息",value1:t.flag_content||"暂无",title2:"占位符",value2:"占位符"},{title1:"收货信息",value1:t.express_info?t.express_info.formatted_address:"--",title2:"占位符",value2:"占位符"},{title1:"快递信息",value1:t.express_info?t.express_info.express_no:"--",title2:"占位符",value2:"占位符"},{title1:"发货人信息",value1:t.express_info?t.express_info.send_mobile:"--",title2:"占位符",value2:"占位符"},{title1:"优惠信息",value1:"占位符",title2:"占位符",value2:"占位符"},{title1:"订单重量",value1:t.weight+" KG",title2:"",value2:""}]}}};t.default=r},ef5e:function(e,t,n){"use strict";n.r(t);var o=n("5a10"),a=n("281e");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"4dee285e",null,!1,o["a"],void 0);t["default"]=u.exports},f335:function(e,t,n){var o=n("a22c8");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var a=n("4f06").default;a("51d469fe",o,!0,{sourceMap:!1,shadowMode:!1})}}]);